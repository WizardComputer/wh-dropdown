{"version":3,"file":"dropdown.js","sourceRoot":"","sources":["src/dropdown.ts"],"names":[],"mappings":"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","sourcesContent":["import { LitElement, html, css } from 'lit'\nimport { customElement, property } from 'lit/decorators.js'\nimport { MenuItem } from \"./item\"\n\n@customElement('wh-dropdown')\nexport class Dropdown extends LitElement {\n  static styles = css`\n  ul {\n    list-style-type: none;\n    margin: 0;\n    padding: var(--padding, 0);\n    min-width: var(--min-width, 0);\n    width: 14rem;\n    z-index: 50;\n    position: absolute;\n    overflow-y: scroll;\n    background-color: var(--background-color, white);\n    max-width: var(--max-width, auto);\n    border-radius: var(--border-radius, 0.25rem);\n    box-shadow: var(--box-shadow, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px);\n    height: 0;\n    border-width: 1px;\n    border-style: solid;\n    border-color: #e8e8e8;\n    opacity: 0;\n    transition: opacity 150ms ease-out;\n  }\n  \n  .open {\n    opacity: 1;\n    height: auto;\n    transition: opacity 150ms ease-out;\n  }\n  \n  ::slotted(*[slot=\"button\"]) {\n    padding: .5rem 1rem .5rem 1rem;\n    font-size: 0.875rem;\n    font-weight: 500;\n    justify-content: center;\n    display: inline-flex;\n    border-width: 1px;\n    background-color: white;\n    border-style: solid;\n    color: #374151;\n    user-select: none;\n    border-color: #D1D5DB;\n    border-radius: 0.375rem;\n    box-shadow: rgba(0, 0, 0, 0.05) 0px 1px 2px 0px;\n  }\n  \n  ::slotted(*:hover[slot=\"button\"]) {\n    background-color: #F9FAFB;\n  }\n`\n\n  @property()\n  opened: boolean = false\n\n  @property()\n  distance: number = 0\n\n  @property()\n  skidding: number = 0\n\n  @property({ attribute: false })\n  list: Array<MenuItem>\n\n  connectedCallback() {\n    super.connectedCallback()\n\n    this.setAttribute(\"tabindex\", \"0\")\n    this.addEventListener(\"keydown\", this.handleKeyPress)\n  }\n\n  disconnectedCallback() {\n    this.removeEventListener(\"keydown\", this.handleKeyPress)\n    super.disconnectedCallback()\n  }\n\n  protected render() {\n    return html`\n      <slot name=\"button\" @click=\"${this.toggle}\"></slot>\n      <ul class=\"${this.opened ? 'open' : ''}\" style=\"margin-top: ${this.distance}px; margin-left: ${this.skidding}px;\">\n          <slot></slot>\n      </ul>\n    `\n  }\n\n  firstUpdated() {\n    this.list = Array.from(document.getElementsByTagName(\"wh-menu-item\")) as MenuItem[]\n    if (this.opened) this.focus()\n  }\n\n  private handleClick = (e: Event) => {\n    if (this.opened && !this.contains(e.target as Node)) return this.close()\n    this.dispatchEvent(new CustomEvent(\"wh-select\", { detail: { item: e.target } }))\n  }\n\n  private toggle = () => {\n    if (this.opened) return this.close()\n    this.open()\n  }\n\n  open = () => {\n    this.opened = true\n    //Don't close dropdown when opening\n    setTimeout(() => document.addEventListener(\"click\", this.handleClick))\n  }\n\n  close = () => {\n    this.opened = false\n    this.focus()\n    document.removeEventListener(\"click\", this.handleClick)\n  }\n\n  private handleKeyPress(e: KeyboardEvent) {\n    switch (e.code) {\n      case \"Tab\":  this.handleFocus(e); break\n      case \"Enter\": this.handleEnter(e.target); break\n      case \"Escape\": this.close(); break\n      case \"ArrowDown\": case \"ArrowUp\": this.handleArrowKeys(e); break\n    }\n  }\n\n  private handleEnter(target: EventTarget | null) {\n    if (target === this) return this.toggle()\n    this.dispatchEvent(new CustomEvent(\"wh-select\", { detail: { item: target } }))\n  }\n\n  private navigate(e: KeyboardEvent) {\n    //Prevent page scroll\n    e.preventDefault()\n\n    if (document.activeElement === this) return this.list[0].focus()\n    this.move(e.code)\n  }\n\n  private move(direction: String) {\n    if (direction === \"ArrowDown\") return this.moveDown()\n    this.moveUp()\n  }\n\n  private moveUp() {\n    const nextElement = document.activeElement.previousElementSibling as MenuItem\n\n    if (nextElement && this.list.includes(nextElement)) return nextElement.focus()\n    this.list[this.list.length - 1].focus()\n  }\n\n  private moveDown() {\n    const nextElement = document.activeElement.nextElementSibling as MenuItem\n\n    if (nextElement && this.list.includes(nextElement)) return nextElement.focus()\n    this.list[0].focus()\n  }\n\n  private handleFocus(e) {\n    if (this.opened) {\n      e.preventDefault()\n      if (document.activeElement === this) return this.list[0].focus()\n      if (document.activeElement?.tagName.toLowerCase() === \"wh-menu-item\") {\n        this.close()\n        this.focus()\n      }\n    }\n  }\n\n  private handleArrowKeys(e) {\n    e.preventDefault()\n    this.opened ? this.navigate(e) : this.open()\n  }\n}"]}